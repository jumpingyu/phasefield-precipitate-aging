\documentclass[10pt]{article}
\usepackage{amsmath,amssymb,mathtools,siunitx}
\usepackage[letterpaper,top=1.25in,bottom=1.25in,left=1in,right=1in]{geometry}
\usepackage[version=3]{mhchem}

\DeclareMathOperator{\sgn}{sgn}

\pagestyle{plain}
\begin{document}
	I am attempting to model solid-state transformations in Inconel 625 based on a published Inconel 718 model \cite{Zhou2014},
	which is a generalization of the KKS binary model \cite{Kim1999}.
	Model parameters are listed in Appendix~\ref{app:params}.
	
	To capture $\delta$, $\mu$, and Laves precipitates in a $\gamma$ matrix, I have chosen Ni--\SI{30}{\percent} Cr--\SI{2}{\percent} Nb as the model system.
	The interdendritic regions in additive manufacturing get enriched to Ni--\SI{31}{\percent} Cr--\SI{13}{\percent} Nb.
	The four-phase three-component model is represented using two composition fields $\left(x_{\ce{Cr}}, x_{\ce{Nb}}\right)$
	and three phase fields $\left(\phi_\delta, \phi_\mu, \phi_{\mathrm{Laves}}\right)$.




	\section{Phase Field Model}
		In this model, the system composition depends on the pure-phase compositions and phase fractions:
		\begin{align}
			x_{\ce{Cr}} &= \left( 1-\sum h(|\phi_i|) \right) x_{\ce{Cr}}^{\gamma}
			             + h(|\phi_\delta|) x_{\ce{Cr}}^{\delta}
			             + h(|\phi_\mu|) x_{\ce{Cr}}^{\mu}
			             + h(|\phi_{\mathrm{L}}|) x_{\ce{Cr}}^{\mathrm{L}}
						\label{eqn:conscr}\\
			x_{\ce{Nb}} &= \left( 1-\sum h(|\phi_i|) \right) x_{\ce{Nb}}^{\gamma}
			             + h(|\phi_\delta|) x_{\ce{Nb}}^{\delta}
			             + h(|\phi_\mu|) x_{\ce{Nb}}^{\mu}
			             + h(|\phi_{\mathrm{L}}|) x_{\ce{Nb}}^{\mathrm{L}}
 			             \label{eqn:consnb}\\
 			h(\phi)     &= \phi^3\left(6\phi^2 - 15\phi + 10\right)\label{eqn:interp}
		\end{align}
		Zhou \emph{et al.} \cite{Zhou2014} defines the order parameter such that $\phi_i=\pm1$ indicates presence of the phase $i$, and $\phi_i=0$ indicates absence.
		The matrix phase $\gamma$ exists where $\sum h(|\phi_i|)=0$. This allows for multiple discrete precipitates of the same phase, without unphysical coalescence.
		The free energy density is
		\begin{align}\nonumber
			f(x,\phi,t) &= \left( 1-\sum h(|\phi_i|) \right) f_\gamma(x_{\ce{Cr}}^{\gamma},x_{\ce{Nb}}^{\gamma})
			             + h(|\phi_{\delta}|) f_\delta(x_{\ce{Cr}}^{\delta},x_{\ce{Nb}}^{\delta})
			             + h(|\phi_{\mu}|) f_\mu(x_{\ce{Cr}}^{\mu},x_\ce{Ni}^{\mu})
			             + h(|\phi_{\ce{L}}|)f_\ce{L}(x_{\ce{Nb}}^\ce{L},x_\ce{Ni}^\ce{L})\\
			            &+ \omega_\delta(\phi_\delta)^2(1-|\phi_\delta|)^2
			             + \omega_\mu(\phi_\mu)^2(1-|\phi_\mu|)^2
			             + \omega_\ce{L}(\phi_\ce{L})^2(1-|\phi_\ce{L}|)^2
			             + \alpha\sum\sum\phi_i^2\phi_j^2
			            \label{eqn:density}
		\end{align}

		The KKS interface model \cite{Kim1999} assumes constant chemical potential through the interface, so
		\begin{align}
			\label{eqn:potcr}
			\tilde{\mu}_{\ce{Cr}} &= \frac{\partial f_\gamma}{\partial x_{\ce{Cr}}^{\gamma}}
			                       = \frac{\partial f_\delta}{\partial x_{\ce{Cr}}^{\delta}}
			                       = \frac{\partial f_\mu}{\partial x_{\ce{Cr}}^{\mu}}
			                       = \frac{\partial f_\ce{L}}{\partial x_{\ce{Cr}}^\ce{L}}\\
			\label{eqn:potnb}
			\tilde{\mu}_{\ce{Nb}} &= \frac{\partial f_\gamma}{\partial x_{\ce{Nb}}^{\gamma}}
			                       = \frac{\partial f_\delta}{\partial x_{\ce{Nb}}^{\delta}}
		    	                   = \frac{\partial f_\mu}{\partial x_{\ce{Nb}}^{\mu}}
			                       = \frac{\partial f_\ce{L}}{\partial x_{\ce{Nb}}^\ce{L}}
		\end{align}
		The pure phase compositions $\left(x_j^i\right)$ are determined by solving the parallel tangent construction constrained by the
		conservation of mass and equality of chemical potentials for each phase,
		\begin{align}
			\label{eqn:Jf1}
			0 &= x_{\ce{Cr}} - \left( 1-\sum h(|\phi_i|) \right)x_{\ce{Cr}}^{\gamma}
			                 - h(|\phi_{\delta}|)x_{\ce{Cr}}^{\delta}
			                 - h(|\phi_{\mu}|)x_{\ce{Cr}}^{\mu}
			                 - h(|\phi_{\ce{L}}|)x_{\ce{Cr}}^{\ce{L}}\\
			\label{eqn:Jf2}
			0 &= x_{\ce{Nb}} - \left( 1-\sum h(|\phi_i|) \right)x_{\ce{Nb}}^{\gamma}
			                 - h(|\phi_{\delta}|)x_{\ce{Nb}}^{\delta}
			                 - h(|\phi_{\mu}|)x_{\ce{Nb}}^{\mu}
			                 - h(|\phi_{\ce{L}}|)x_{\ce{Nb}}^{\ce{L}}\\
			\label{eqn:Jf3}
			0 &= \frac{\partial f_{\gamma}}{\partial x_{\ce{Cr}}^{\gamma}} - \frac{\partial f_{\delta}}{\partial x_{\ce{Cr}}^{\delta}}\\
			\label{eqn:Jf4}
			0 &= \frac{\partial f_{\gamma}}{\partial x_{\ce{Nb}}^{\gamma}} - \frac{\partial f_{\delta}}{\partial x_{\ce{Nb}}^{\delta}}\\
			\label{eqn:Jf5}
			0 &= \frac{\partial f_{\gamma}}{\partial x_{\ce{Cr}}^{\gamma}} - \frac{\partial f_{\mu}}{\partial x_{\ce{Cr}}^{\mu}}\\
			\label{eqn:Jf6}
			0 &= \frac{\partial f_{\gamma}}{\partial x_{\ce{Nb}}^{\gamma}} - \frac{\partial f_{\mu}}{\partial x_{\ce{Nb}}^{\mu}}\\
			\label{eqn:Jf7}
			0 &= \frac{\partial f_{\gamma}}{\partial x_{\ce{Cr}}^{\gamma}} - \frac{\partial f_{\ce{L}}}{\partial x_{\ce{Cr}}^{\ce{L}}}\\
			\label{eqn:Jf8}
			0 &= \frac{\partial f_{\gamma}}{\partial x_{\ce{Nb}}^{\gamma}} - \frac{\partial f_{\ce{L}}}{\partial x_{\ce{Nb}}^{\ce{L}}}
		\end{align}
		in which each partial derivative is evaluated at the pure phase composition $x_j^i$, not the system composition $x_j$.
		This set of eight equations should uniquely solve for the eight unknown pure compositions at each point,
		given that $x_\ce{Ni}^i = 1-x_{\ce{Cr}}^i-x_{\ce{Nb}}^i$.
		This solution is found using the GNU Scientific Library's multiroot solver, provided these eight equations and the
		Jacobian matrix defined by their partial derivatives with respect to $x_{\ce{Cr}}^{\gamma}$,
		                                                                     $x_{\ce{Nb}}^{\gamma}$,
		                                                                     $x_{\ce{Cr}}^{\delta}$,
		                                                                     $x_{\ce{Nb}}^{\delta}$,
		                                                                     $x_{\ce{Cr}}^{\mu}$,
		                                                                     $x_{\ce{Nb}}^{\mu}$,
		                                                                     $x_{\ce{Cr}}^\ce{L}$, and
		                                                                     $x_{\ce{Nb}}^\ce{L}$.\footnote{
		The system compositions $x_{\ce{Cr}}$ and $x_{\ce{Nb}}$ depend on $x_{\ce{Cr}}^i$ and $x_{\ce{Nb}}^i$; these ten values are stored as field variables.
		}
		The complete Jacobian matrix is written in Appendix~\ref{app:jacobian}.

		The first guess for each composition is made using line compound approximations for each phase,
		applied after the initial condition $(t=0)$.
		Subsequent guesses simply copy the result of the previous timestep.
		During the iterations, $x_{\ce{Cr}}$,
		                       $x_{\ce{Nb}}$,
		                       $\phi_{\delta}$,
		                       $\phi_{\mu}$, and
		                       $\phi_{\ce{L}}$ are held constant.
		In the event that a valid solution cannot be found, at any time during the simulation,
		the line compound guesses are applied with a small random offset.
		Details are provided in Appendix~\ref{app:linecomp}.

	



	\section{Thermodynamic Model}
		The pure phase free energies depend on Gibbs free energy expressions, divided by molar volume to convert from \si{\joule/\mole} to \si{\joule/\cubic\meter}.
		The Gibbs free energy expressions are read from a CALPHAD database using pycalphad,
		then manipulated using sympy to substitute sublattice compositions $y$ with system compositions $x$.
		This substitution is not valid over the entire ternary composition space.
		It is therefore necessary to build approximate free energies, which is done in one of two ways:
		\begin{enumerate}
			\item Paraboloid approximations for each phase: %$f\approx V_m^{-1}\sum C_j(x_j-x_j^e)^2$.
			      \begin{align}
			      f_{\gamma} &\approx \left.\frac{1}{2}\frac{\partial^2 f_{\gamma}}{\partial x_{\ce{Cr}}^{\gamma}}\right|_{\prescript{e}{}{x}_{\ce{Cr}}^{\gamma}}
			                          \left(x_{\ce{Cr}} - \prescript{e}{}{x}_{\ce{Cr}}^{\gamma}\right)
			                        + \left.\frac{1}{2}\frac{\partial^2 f_{\gamma}}{\partial x_{\ce{Nb}}^{\gamma}}\right|_{\prescript{e}{}{x}_{\ce{Nb}}^{\gamma}}
			                          \left(x_{\ce{Nb}} - \prescript{e}{}{x}_{\ce{Nb}}^{\gamma}\right)
			                        + f^0_{\gamma}\left(\prescript{e}{}{x}_{\ce{Cr}}^{\gamma}, \prescript{e}{}{x}_{\ce{Nb}}^{\gamma}\right)\\ 
			      f_{\delta} &\approx \left.\frac{1}{2}\frac{\partial^2 f_{\delta}}{\partial x_{\ce{Cr}}^{\delta}}\right|_{\prescript{e}{}{x}_{\ce{Cr}}^{\delta}}
			                          \left(x_{\ce{Cr}} - \prescript{e}{}{x}_{\ce{Cr}}^{\delta}\right)
			                        + \left.\frac{1}{2}\frac{\partial^2 f_{\delta}}{\partial x_{\ce{Nb}}^{\delta}}\right|_{\prescript{e}{}{x}_{\ce{Nb}}^{\delta}}
			                          \left(x_{\ce{Nb}} - \prescript{e}{}{x}_{\ce{Nb}}^{\delta}\right)
			                        + f^0_{\delta}\left(\prescript{e}{}{x}_{\ce{Cr}}^{\delta}, \prescript{e}{}{x}_{\ce{Nb}}^{\delta}\right)\\ 
			      f_{\mu} &\approx    \left.\frac{1}{2}\frac{\partial^2 f_{\mu}}{\partial x_{\ce{Cr}}^{\mu}}\right|_{\prescript{e}{}{x}_{\ce{Cr}}^{\mu}}
			                          \left(x_{\ce{Cr}} - \prescript{e}{}{x}_{\ce{Cr}}^{\mu}\right)
			                        + \left.\frac{1}{2}\frac{\partial^2 f_{\mu}}{\partial x_{\ce{Nb}}^{\mu}}\right|_{\prescript{e}{}{x}_{\ce{Nb}}^{\mu}}
			                          \left(x_{\ce{Nb}} - \prescript{e}{}{x}_{\ce{Nb}}^{\mu}\right)
			                        + f^0_{\mu}\left(\prescript{e}{}{x}_{\ce{Cr}}^{\mu}, \prescript{e}{}{x}_{\ce{Nb}}^{\mu}\right)\\ 
			      f_{\ce{L}} &\approx \left.\frac{1}{2}\frac{\partial^2 f_{\ce{L}}}{\partial x_{\ce{Nb}}^{\ce{L}}}\right|_{\prescript{e}{}{x}_{\ce{Nb}}^{\ce{L}}}
			                          \left(x_{\ce{Nb}} - \prescript{e}{}{x}_{\ce{Nb}}^{\ce{L}}\right)
			                        + \left.\frac{1}{2}\frac{\partial^2 f_{\ce{L}}}{\partial x_{\ce{Ni}}^{\ce{L}}}\right|_{\prescript{e}{}{x}_{\ce{Ni}}^{\ce{L}}}
			                          \left(1-x_{\ce{Cr}}-x_{\ce{Nb}} - \prescript{e}{}{x}_{\ce{Ni}}^{\ce{L}}\right)
			                        + f^0_{\ce{L}}\left(\prescript{e}{}{x}_{\ce{Nb}}^{\ce{L}}, \prescript{e}{}{x}_{\ce{Ni}}^{\ce{L}}\right)
			      \end{align}
			      The curvature $C$ of free energy for each element,
			      $C_j=\left.\frac{1}{2}\frac{\partial^2 f}{\partial {x_j}^2}\right|_{x_j=\prescript{e}{}{x}_j}$,
			      and the minimum energy $f^0_{\nu}\left(\prescript{e}{}{x}_{i}^{\nu}, \prescript{e}{}{x}_{j}^{\nu}\right)$,
			      are computed from the CALPHAD expression.\footnote{In the following exposition, $j$ is the index for elements and $i$ the index for phases.
	              }
			      The equilibrium value for each element $\prescript{e}{}{x}_j$ is taken from the constrained minimum
			      of the CALPHAD free energy expression for each phase, within the valid region and within the ternary simplex.
			\item Piecewise functions are constructed using the manipulated CALPHAD expression inside its defined range,
			      and the paraboloid approximation outside that range.
		\end{enumerate}
		Phase diagrams constructed by the convex hull method show the pure phase fields from the paraboloid model are larger
		and somewhat distorted relative to the CALPHAD model, but the two diagrams are similar.
		To simplify the model as much as possible while troubleshooting numerics, the paraboloid approximation is used in the code.
		Note that Zhou \emph{et al.} \cite{Zhou2014} sets $C_j=C_j^{\gamma}$ rather than specifying different curvatures for each phase,
		while my code (at the moment) allows each phase its own curvature.
	



	\newpage
	\section{Equations of Motion for Phases $\{\phi\}$}
		The $\{\phi_i\}$ are not conserved, so Allen-Cahn dynamics are assumed:
		\begin{equation}
			\frac{\partial \phi_i}{\partial t} = -L_i\frac{\delta\mathcal{F}}{\delta\phi_i} = -L_i\left(\frac{\partial f}{\partial \phi_i} - \kappa_i\nabla^2\phi_i\right).
		\end{equation}
		From Eqn.~\ref{eqn:density},
		\begin{align}\nonumber
			\frac{\partial f}{\partial \phi_n} &= -\sgn(\phi_i)h'(|\phi_n|)\left[f_{\gamma}(x_{\ce{Cr}}^{\gamma},x_{\ce{Nb}}^{\gamma}) - f_n(x_{\ce{Cr}}^n,x_{\ce{Nb}}^n)\right]
			                                    + \left[1 - \sum h(|\phi_i|)\right] \frac{\partial f_{\gamma}}{\partial \phi_n}
			                                    + h(|\phi_n|)\frac{\partial f_n}{\partial \phi_n}\\
			                                   &+ 2\omega_n\phi_n\left(1-|\phi_n|\right)^2 - 2\omega_n\phi_n^2\sgn(\phi_n)\left(1-|\phi_n|\right)
			                                    + 2\alpha\phi_n\sum_{i\neq n}\phi_i^2.
		\end{align}
		Invoking the multivariable chain rule and chemical potential (Eqns.~\ref{eqn:potcr}~and~\ref{eqn:potnb}),
		\begin{align}\nonumber
			\frac{\partial f_{\nu}}{\partial \phi_{\nu}} &= \sum_j \frac{\partial f_{\nu}}{\partial x_j^{\nu}}\frac{\partial x_j^{\nu}}{\partial \phi_{\nu}}
			                                         = \sum_j\frac{\partial x_j^{\nu}}{\partial \phi_{\nu}}\tilde{\mu}_j\\
			\nonumber
			\frac{\partial f}{\partial \phi_n} &= -\sgn(\phi_n)h'(|\phi_n|)\left[f_{\gamma}(x_{\ce{Cr}}^{\gamma},x_{\ce{Nb}}^{\gamma}) - f_n(x_{\ce{Cr}}^n,x_{\ce{Nb}}^n)\right]
			                                    + \sum_j\left(\left[1 - \sum h(|\phi_i|)\right] \frac{\partial x_j^{\gamma}}{\partial \phi_n}
			                                    + h(|\phi_n|)\frac{\partial x_j^n}{\partial \phi_n}\right)\tilde{\mu}_j\\
			                                   &+ 2\omega_n\phi_n\left(1-|\phi_n|\right)\left[1 - h(|\phi_n|) - \sgn(\phi_n)\phi_n\right]
			                                    + 2\alpha\phi_n\sum_{i\neq n}\phi_i^2.\label{eqn:potentphi}
		\end{align}

		Implicitly differentiating both sides of the expression for system composition,
		Eqns.~\ref{eqn:conscr} and \ref{eqn:consnb}, with respect to a phase,\footnote{
		Cf. Eqn.~6.91 in Provatas and Elder \cite{Provatas2010}. The amount of species should not change explicitly with changes in phase.
		}
		\begin{align}
			\frac{\partial x_j}{\partial \phi_n} &= -\sgn(\phi_n)h'(|\phi_n|)\left[x_j^{\gamma} - x_j^n\right]
			                                          + \left[1 - \sum h(|\phi_i|)\right] \frac{\partial x_j^{\gamma}}{\partial \phi_n}
			                                          + h(|\phi_n|) \frac{\partial x_j^{n}}{\partial \phi_n}\\
			\frac{\partial x_j}{\partial \phi_n} &\equiv 0\\
			\sgn(\phi_n)h'(|\phi_n|)\left[x_j^{\gamma} - x_j^n\right] &= \left[1 - \sum h(|\phi_i|)\right] \frac{\partial x_j^{\gamma}}{\partial \phi_n}
			                                                           + h(|\phi_n|) \frac{\partial x_j^{n}}{\partial \phi_n}.
			                                                           \label{eqn:xdiff}
		\end{align}
		Substituting Eqn.~\ref{eqn:xdiff} into Eqn.~\ref{eqn:potentphi} and simplifying,
		we arrive at the final result:
		\begin{align}\nonumber
			\frac{\partial f}{\partial \phi_n} &= -\sgn(\phi_n)h'(|\phi_n|)\left(f_{\gamma}(x_{\ce{Cr}}^{\gamma},x_{\ce{Nb}}^{\gamma})
			                                    - f_n(x_{\ce{Cr}}^n,x_{\ce{Nb}}^n) - \sum_j\left[x_j^{\gamma} - x_j^n\right]\tilde{\mu}_j\right)\\
			                                   &+ 2\omega_n\phi_n\left(1-|\phi_n|\right)\left[1 - h(|\phi_n|) - \sgn(\phi_n)\phi_n\right]
			                                    + 2\alpha\phi_n\sum_{i\neq n}\phi_i^2.
			\label{eqn:phieom}
		\end{align}		



	\newpage
	\section{Equations of Motion for Compositions $\{x\}$}
		Composition is conserved, so we choose Cahn-Hilliard dynamics for $x$:
		\begin{equation}
			\frac{\partial x_{\ell}}{\partial t} = \nabla\cdot\sum_k M_{\ell k}\nabla\frac{\delta\mathcal{F}}{\delta x_k}
			                                     = \nabla\cdot\sum_k M_{\ell k}\nabla\frac{\partial f}{\partial x_k}.\label{eqn:fick}
		\end{equation}
		
		Differentiating Eqn.~\ref{eqn:density}, then applying the chain rule and the definition of chemical potential,
		\begin{align}
			\frac{\partial f}{\partial x_k} &= \left[1-\sum_{\nu}h(|\phi_{\nu}|)\right]\frac{\partial f_{\gamma}}{\partial x_k}
			                                 + \sum_{\nu}h(|\phi_{\nu}|)\frac{\partial f_{\nu}}{\partial x_k}\\
			                                &= \sum_j\left[1-\sum_{\nu}h(|\phi_{\nu}|)\right]\frac{\partial f_{\gamma}}{\partial x_j^{\gamma}}\frac{\partial x_j^{\gamma}}{\partial x_k}
			                                 + \sum_j\sum_{\nu}h(|\phi_{\nu}|)\frac{\partial f_{\nu}}{\partial x_j^{\nu}}\frac{\partial x_j^{\nu}}{\partial x_k}\\
			                                &= \sum_j\left(\left[1-\sum_{\nu}h(|\phi_{\nu}|)\right]\frac{\partial x_j^{\gamma}}{\partial x_k}\mu_j^{\gamma}
			                                 + \sum_{\nu}h(|\phi_{\nu}|)\frac{\partial x_j^{\nu}}{\partial x_k}\mu_j^{\nu}\right).
		\end{align}
		Since the pure-phase composition $x_j^{\nu}$ depends only on $x_j$, $\frac{\partial x_j^{\nu}}{\partial x_k} = \delta_{jk}$, and
		\begin{equation}
			\frac{\partial f}{\partial x_k} = \left[1-\sum_{\nu}h(|\phi_{\nu}|)\right]\mu_k^{\gamma} + \sum_{\nu}h(|\phi_{\nu}|)\mu_k^{\nu}.
		\end{equation}
		In this phase field formulation, $\tilde{\mu}_k\equiv\mu_k^{\gamma}=\mu_k^{\nu}$ (Eqn.~\ref{eqn:potcr}) and
		\begin{equation}
			\frac{\partial f}{\partial x_k} = \tilde{\mu}_k.\label{eqn:potentc}
		\end{equation}
		Substituting Eqn.~\ref{eqn:potentc} into Eqn.~\ref{eqn:fick}, with a proportionality constant $V_m^2$, we 
		\begin{equation}
			\frac{\partial x_{\ell}}{\partial t} = V_m^2 \nabla\cdot\sum_k M_{\ell k}\nabla\tilde{\mu}_k.
		\end{equation}
		Since we do not have detailed interfacial data, the mobility matrix is diagonal and $M_{\ell k} = \delta_{\ell k}M_{\ell}$,
		\emph{i.e.} the mobility of element $\ell$ only depends on its own concentration field.
		Using this simplification, we can recover the form presented by Zhou \emph{et al.} \cite{Zhou2014}:
		\begin{equation}
			\frac{\partial x_{\ell}}{\partial t} = V_m^2 \nabla \cdot M_{\ell} \nabla \tilde{\mu}_k.\label{eqn:zhoudiff}
		\end{equation}

		If we further invoke the chain rule,
		\begin{align}
			\frac{\partial x_{\ell}}{\partial t} &= V_m^2 \nabla\cdot M_{\ell}\sum_j\frac{\partial \tilde{\mu}_k}{\partial x_j^{\gamma}}\nabla x_j^{\gamma}\\
			                                     &= V_m^2 \nabla\cdot M_{\ell}\sum_j\frac{\partial^2 f_{\gamma}}{\partial x_{\ell}^{\gamma} \partial x_j^{\gamma}}\nabla x_j^{\gamma}
		\end{align}
		For the specific case of paraboloid approximations to the pure free energy expressions, the cross-terms of curvature are zero,
		and we have an equivalent result in terms of composition rather than chemical potential:
		\begin{equation}
			\frac{\partial x_{\ell}}{\partial t} = 2V_m^2 \nabla\cdot M_{\ell}C_{\ell}^{\gamma}\nabla x_{\ell}^{\gamma},\label{eqn:interdiff}
		\end{equation}
		with curvature $C_{\ell}^{\gamma}=\frac{1}{2}\frac{\partial^2 f_{\gamma}}{\partial \left({x_{\ell}^{\gamma}}\right)^2}$. We can also use the definition of diffusivity:
		\begin{align}
			D_{\ell j}^{\nu} &= \sum_k M_{\ell k}^{\nu}\frac{\partial^2 f_{\gamma}}{\partial x_{\ell}^{\nu} \partial x_j^{\nu}}\\
			\frac{\partial x_{\ell}}{\partial t} &= \nabla\cdot\sum_j D_{\ell j}^{\gamma} \nabla x_j^{\gamma}.
		\end{align}
		For this particular system, we only have a diffusivity expression for \ce{Nb} in pure fcc Ni (\emph{i.e.}, $\gamma$ phase)
		\cite{Karunaratne2005},	$D_{\ce{Nb}}^{\gamma}(T)$.
		Assuming similar diffusivities of \ce{Cr} and \ce{Nb} in \ce{Ni}, our final isothermal diffusion equation becomes
		\begin{equation}
			\frac{\partial x_{\ell}}{\partial t} = D_{\ce{Nb}}^{\gamma}\nabla^2 x_{\ell}^{\gamma}.\label{eqn:diffusion}
		\end{equation}
		



	\appendix
	\newpage
	\section{Model parameters}\label{app:params}
		\begin{table}[ht]\centering
			\caption{Model parameters used in this work}
			\begin{tabular}{lll}\hline
				Parameter            & Symbol                   & Value\\\hline
				Mesh resolution      & $\Delta x$               & \SI{5.0e-9}{\meter}\\
				Timestep             & $\Delta t$               & \SI{5.0e-7}{\second}\\
				Temperature          & $T$                      & \SI{870}{\degreeCelsius}\\
				Molar volume         & $V_m$                    & \SI{1.0e-5}{\cubic\meter/\mole}\\
				Trijunction penalty  & $\alpha$                 & \SI{1.07e11}{\joule/\cubic\meter}\\
				Interfacial energy   & $\sigma_\delta
				                       =\sigma_\mu
				                       =\sigma_\ce{L}$          & \SI{1.01}{\joule/\square\meter}\\
				Gradient penalty     & $\kappa_\delta
				                       =\kappa_\mu
				                       =\kappa_\ce{L}$          & \SI{1.24e-8}{\joule/\meter}\\
				Mobility             & $M_{\ce{Cr}}
				                       = M_{\ce{Nb}}$           & \SI{2.42e-18}{\square\mole/\newton\second\square\meter}\\
				Diffusivity          & $D_{\ce{Cr}}
				                       = D_{\ce{Nb}}$           & \SI{1.58e-16}{\square\meter/\second}\\
				Mobility             & $L_\delta
				                       =L_\mu
				                       =L_\ce{L}$               & \SI{2.904e-11}{\square\meter/\newton/\second}\\
				Interface width      & $2\lambda$               & $7\Delta x$\\
				Interface width      & $2\lambda$               & \SI{35e-9}{\meter}\\
				Well height          & $\omega_\delta
				                       =\omega_\mu
				                       =\omega_\ce{L}$          & $6.6 \sigma_\delta / 2\lambda$\\
				Well height          & $\omega_\delta
				                       =\omega_\mu
				                       =\omega_\ce{L}$          & \SI{1.9e8}{\joule/\cubic\meter}\\
				$\gamma$ curvature   & $C_{\ce{Cr}}^{\gamma}$   & \SI{4.8e10}{\joule/\cubic\meter}\\
				                     & $C_{\ce{Nb}}^{\gamma}$   & \SI{6.1e9}{\joule/\cubic\meter}\\
				$\delta$ curvature   & $C_{\ce{Cr}}^{\delta}$   & \SI{5.4e10}{\joule/\cubic\meter}\\
				                     & $C_{\ce{Nb}}^{\delta}$   & \SI{6.8e11}{\joule/\cubic\meter}\\
				$\mu$ curvature      & $C_{\ce{Cr}}^{\mu}$      & \SI{4.5e10}{\joule/\cubic\meter}\\
				                     & $C_{\ce{Nb}}^{\mu}$        & \SI{2.1e10}{\joule/\cubic\meter}\\
				Laves curvature      & $C_{\ce{Nb}}^\ce{L}$     & \SI{1.2e11}{\joule/\cubic\meter}\\
				                     & $C_{\ce{Ni}}^\ce{L}$     & \SI{1.1e10}{\joule/\cubic\meter}\\
				$\gamma$ composition & $\prescript{e}{}{x}_{\ce{Cr}}^{\gamma}$ & \SI{1.00}{\percent}\\
				                     & $\prescript{e}{}{x}_{\ce{Nb}}^{\gamma}$ & \SI{32.3}{\percent}\\
				$\delta$ composition & $\prescript{e}{}{x}_{\ce{Cr}}^{\delta}$ & \SI{0.88}{\percent}\\
				                     & $\prescript{e}{}{x}_{\ce{Nb}}^{\delta}$ & \SI{24.9}{\percent}\\
				$\mu$ composition    & $\prescript{e}{}{x}_{\ce{Cr}}^{\mu}$    & \SI{1.06}{\percent}\\
				                     & $\prescript{e}{}{x}_{\ce{Nb}}^{\mu}$    & \SI{50.8}{\percent}\\
				Laves composition    & $\prescript{e}{}{x}_{\ce{Nb}}^{\ce{L}}$ & \SI{30.6}{\percent}\\
				                     & $\prescript{e}{}{x}_{\ce{Ni}}^{\ce{L}}$ & \SI{49.1}{\percent}\\
				$\gamma$ minimum     & $f^0_{\gamma}\left(\prescript{e}{}{x}_{\ce{Cr}}^{\gamma}, \prescript{e}{}{x}_{\ce{Nb}}^{\gamma}\right)$
				                                                & \SI{-7.9722e9}{\joule/\cubic\meter}\\
				$\delta$ minimum     & $f^0_{\delta}\left(\prescript{e}{}{x}_{\ce{Cr}}^{\delta}, \prescript{e}{}{x}_{\ce{Nb}}^{\delta}\right)$
				                                                & \SI{-8.5488e9}{\joule/\cubic\meter}\\
				$\mu$ minimum        & $f^0_{\mu}\left(\prescript{e}{}{x}_{\ce{Cr}}^{\mu}, \prescript{e}{}{x}_{\ce{Nb}}^{\mu}\right)$
				                                                & \SI{-8.0076e9}{\joule/\cubic\meter}\\
				Laves minimum        & $f^0_{\ce{L}}\left(\prescript{e}{}{x}_{\ce{Nb}}^{\ce{L}}, \prescript{e}{}{x}_{\ce{Ni}}^{\ce{L}}\right)$
				                                                & \SI{-8.0522e9}{\joule/\cubic\meter}\\
				\hline
			\end{tabular}
		\end{table}
	
	\section{Units of the Diffusion Equations}
		The expression $\frac{\partial x}{\partial t}$ should have units of \si{\per\second}.
		For Eqn.~\ref{eqn:diffusion}, this is clearly so:
		\begin{align*}
			\frac{1}{\si{\second}} &= \frac{\si{\square\meter}}{\si{\second}}\frac{1}{\si{\square\meter}}\\
			                       &= \frac{1}{\si{\second}}.
		\end{align*}
		
		The unusual units in Eqn.~\ref{eqn:zhoudiff} make the equivalence just slightly less obvious,
		but it is straightforward nonetheless:
		\begin{align*}
			\frac{1}{\si{\second}} &= \frac{\si{\meter^6}}{\si{\square\mole}}
			                          \frac{\si{\square\mole}}{\si{\newton\second\square\meter}}
			                          \frac{\si{\joule}}{\si{\cubic\meter\square\meter}}
			                       = \frac{\si{\meter^6}}{\si{\square\mole}}
			                          \frac{\si{\square\mole\square\second}}{\si{\kilo\gram\meter\second\square\meter}}
			                          \frac{\si{\kilo\gram\square\meter}}{\si{\cubic\meter\square\meter\square\second}}
			                       = \frac{\si{\kilo\gram\meter\tothe8\square\second\square\mole}}{\si{\kilo\gram\meter\tothe8\cubic\second\square\mole}}\\
			                       &= \frac{1}{\si{\second}}.
		\end{align*}

		Eqns.~\ref{eqn:zhoudiff},~\ref{eqn:interdiff},~and~\ref{eqn:diffusion} are interchangeable, simply adjust the timestep to satisfy
		\[
			\Delta t < \mathrm{min}\left(\frac{\left({\Delta x}\right)^2}{8 V_m^2 M_{\ce{Nb}} C_{\ce{Nb}}^{\gamma}}, \frac{\left({\Delta x}\right)^2}{4 D_{\ce{Nb}}}\right).
		\]

	\section{Common Tangent}\label{app:jacobian}
		The Jacobian matrix $\left(J_{ij}=\frac{\partial f_i}{\partial x_j}\right)$ for this system of eight equations, depending on the eight unknown compositions $\{x_{\ce{Cr}}^i\}, \{x_{\ce{Nb}}^i\}$, is written
		
		\begin{table}[ht]\centering
		\begin{small}
		\begin{tabular}{|c|cccccccc|}\hline
		$J_{ij}$  & $\partial x_{\ce{Cr}}^{\gamma}$ & $\partial x_{\ce{Nb}}^{\gamma}$ & $\partial x_{\ce{Cr}}^{\delta}$ & $\partial x_{\ce{Nb}}^{\delta}$
		  & $\partial x_{\ce{Cr}}^{\mu}$ & $\partial x_{\ce{Nb}}^{\mu}$ & $\partial x_{\ce{Cr}}^{\ce{L}}$ & $\partial x_{\ce{Nb}}^{\ce{L}}$\\\hline
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf1}})$ & $-1+\sum h(|\phi_i|)$ & 0 & $-h(|\phi_{\delta}|)$ & 0 & $-h(|\phi_{\mu}|)$ & 0 & $-h(|\phi_{\ce{L}}|)$ & 0\\
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf2}})$ & 0 & $-1+\sum h(|\phi_i|)$ & 0 & $-h(|\phi_{\delta}|)$ & 0 & $-h(|\phi_{\mu}|)$ & 0 & $-h(|\phi_{\ce{L}}|)$\\
		%
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf3}})$ & $\frac{\partial^2 f_{\gamma}}{\partial(x_{\ce{Cr}}^{\gamma})^2}$ & $\frac{\partial^2 f_{\gamma}}{\partial x_{\ce{Cr}}^{\gamma}\partial x_{\ce{Nb}}^{\gamma}}$ 
		& $\frac{\partial^2 f_{\delta}}{\partial(x_{\ce{Cr}}^{\delta})^2}$ & $\frac{\partial^2 f_{\delta}}{\partial x_{\ce{Cr}}^{\delta}\partial x_{\ce{Nb}}^{\delta}}$
		& 0 & 0 & 0 & 0\\
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf4}})$ & $\frac{\partial^2 f_{\gamma}}{\partial x_{\ce{Nb}}^{\gamma}\partial x_{\ce{Cr}}^{\gamma}}$ & $\frac{\partial^2 f_{\gamma}}{\partial(x_{\ce{Nb}}^{\gamma})^2}$
		& $\frac{\partial^2 f_{\delta}}{\partial x_{\ce{Nb}}^{\delta} \partial x_{\ce{Cr}}^{\delta}}$ & $\frac{\partial^2 f_{\delta}}{\partial(x_{\ce{Nb}}^{\delta})^2}$
		& 0 & 0 & 0 & 0\\
		%
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf5}})$ & $\frac{\partial^2 f_{\gamma}}{\partial(x_{\ce{Cr}}^{\gamma})^2}$ & $\frac{\partial^2 f_{\gamma}}{\partial x_{\ce{Cr}}^{\gamma}\partial x_{\ce{Nb}}^{\gamma}}$ 
		& 0 & 0 & $\frac{\partial^2 f_{\mu}}{\partial(x_{\ce{Cr}}^{\mu})^2}$ & $\frac{\partial^2 f_{\mu}}{\partial x_{\ce{Cr}}^{\mu}\partial x_{\ce{Nb}}^{\mu}}$
		& 0 & 0\\
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf6}})$ & $\frac{\partial^2 f_{\gamma}}{\partial x_{\ce{Nb}}^{\gamma}\partial x_{\ce{Cr}}^{\gamma}}$ & $\frac{\partial^2 f_{\gamma}}{\partial(x_{\ce{Nb}}^{\gamma})^2}$
		& 0 & 0 & $\frac{\partial^2 f_{\mu}}{\partial x_{\ce{Nb}}^{\mu} \partial x_{\ce{Cr}}^{\mu}}$ & $\frac{\partial^2 f_{\mu}}{\partial(x_{\ce{Nb}}^{\mu})^2}$
		& 0 & 0\\
		%
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf7}})$ & $\frac{\partial^2 f_{\gamma}}{\partial(x_{\ce{Cr}}^{\gamma})^2}$ & $\frac{\partial^2 f_{\gamma}}{\partial x_{\ce{Cr}}^{\gamma}\partial x_{\ce{Nb}}^{\gamma}}$ 
		& 0 & 0 & 0 & 0 & $\frac{\partial^2 f_{\ce{L}}}{\partial(x_{\ce{Cr}}^{\ce{L}})^2}$ & $\frac{\partial^2 f_{\ce{L}}}{\partial x_{\ce{Cr}}^{\ce{L}}\partial x_{\ce{Nb}}^{\ce{L}}}$
		\\
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf8}})$ & $\frac{\partial^2 f_{\gamma}}{\partial x_{\ce{Nb}}^{\gamma}\partial x_{\ce{Cr}}^{\gamma}}$ & $\frac{\partial^2 f_{\gamma}}{\partial(x_{\ce{Nb}}^{\gamma})^2}$
		& 0 & 0 & 0 & 0 & $\frac{\partial^2 f_{\ce{L}}}{\partial x_{\ce{Nb}}^{\ce{L}} \partial x_{\ce{Cr}}^{\ce{L}}}$ & $\frac{\partial^2 f_{\ce{L}}}{\partial(x_{\ce{Nb}}^{\ce{L}})^2}$
		\\\hline
		%
		%
		\end{tabular}
		\end{small}
		\end{table}

	For the specific case of paraboloid approximations for the pure phase free energies, the matrix reduces to
	
		\begin{table}[ht]\centering
		\begin{small}
		\begin{tabular}{|c|cccccccc|}\hline
		$J_{ij}$  & $\partial x_{\ce{Cr}}^{\gamma}$ & $\partial x_{\ce{Nb}}^{\gamma}$ & $\partial x_{\ce{Cr}}^{\delta}$ & $\partial x_{\ce{Nb}}^{\delta}$
		  & $\partial x_{\ce{Cr}}^{\mu}$ & $\partial x_{\ce{Nb}}^{\mu}$ & $\partial x_{\ce{Cr}}^{\ce{L}}$ & $\partial x_{\ce{Nb}}^{\ce{L}}$\\\hline
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf1}})$ & $-1+\sum h(|\phi_i|)$ & 0 & $-h(|\phi_{\delta}|)$ & 0 & $-h(|\phi_{\mu}|)$ & 0 & $-h(|\phi_{\ce{L}}|)$ & 0\\
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf2}})$ & 0 & $-1+\sum h(|\phi_i|)$ & 0 & $-h(|\phi_{\delta}|)$ & 0 & $-h(|\phi_{\mu}|)$ & 0 & $-h(|\phi_{\ce{L}}|)$\\
		%
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf3}})$ & $2C_{\ce{Cr}}^{\gamma}$ & $0$ 
		& $2C_{\ce{Cr}}^{\delta}$ & $0$ & 0 & 0 & 0 & 0\\
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf4}})$ & $0$ & $2C_{\ce{Nb}}^{\gamma}$
		& $0$ & $2C_{\ce{Nb}}^{\delta}$ & 0 & 0 & 0 & 0\\
		%
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf5}})$ & $2C_{\ce{Cr}}^{\gamma}$ & $0$ 
		& 0 & 0 & $2C_{\ce{Cr}}^{\mu}$ & $0$	& 0 & 0\\
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf6}})$ & $0$ & $2C_{\ce{Nb}}^{\gamma}$
		& 0 & 0 & $0$ & $2C_{\ce{Nb}}^{\mu}$	& 0 & 0\\
		%
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf7}})$ & $2C_{\ce{Cr}}^{\gamma}$ & $0$ 
		& 0 & 0 & 0 & 0 & $\frac{\partial^2 f_{\ce{L}}}{\partial(x_{\ce{Cr}}^{\ce{L}})^2}$ & $\frac{\partial^2 f_{\ce{L}}}{\partial x_{\ce{Cr}}^{\ce{L}}\partial x_{\ce{Nb}}^{\ce{L}}}$
		\\
		%
		$\partial (\mathrm{Eqn.}~{\ref{eqn:Jf8}})$ & $0$ & $2C_{\ce{Nb}}^{\gamma}$
		& 0 & 0 & 0 & 0 & $\frac{\partial^2 f_{\ce{L}}}{\partial x_{\ce{Nb}}^{\ce{L}} \partial x_{\ce{Cr}}^{\ce{L}}}$ & $\frac{\partial^2 f_{\ce{L}}}{\partial(x_{\ce{Nb}}^{\ce{L}})^2}$
		\\\hline
		%
		%
		\end{tabular}
		\end{small}
		\end{table}


	\section{Line Compound Approximations}\label{app:linecomp}
		Initial guesses, and replacement values for parallel tangent iterations which fail to converge,
		are made using line compound approximations based on the pure phase regions observed on the Cr--Nb--Ni phase diagram.
		Specifically, the composition of one species is set equal to a constant value,
		and the other two are scaled from their ``real'' values (as opposed to the ``fictitious'' quantities being solved for)
		to satisfy conservation of mass in each point $\left(\sum x_i=1\right)$.
		Replacements for un-converged values are perturbed with random noise of amplitude $\varepsilon=\num{e-5}$.
		
		\begin{align*}
			x_{\ce{Nb}}^{\gamma} &= 0.015\\
			x_{\ce{Cr}}^{\gamma} &= \frac{x_{\ce{Cr}}}{x_{\ce{Cr}} + x_{\ce{Nb}}^{\gamma} + x_{\ce{Ni}}}\\
			                                      &= \frac{x_{\ce{Cr}}}{1 + x_{\ce{Nb}}^{\gamma} - x_{\ce{Nb}}} 
		\end{align*}
		\begin{align*}
			x_{\ce{Ni}}^{\delta} &= 0.75\\
			x_{\ce{Cr}}^{\delta} &= \frac{x_{\ce{Cr}}}{x_{\ce{Cr}} + x_{\ce{Nb}} + x_{\ce{Ni}}^{\delta}}\\
			x_{\ce{Nb}}^{\delta} &= \frac{x_{\ce{Nb}}}{x_{\ce{Cr}} + x_{\ce{Nb}} + x_{\ce{Ni}}^{\delta}}
		\end{align*}
		\begin{align*}
			x_{\ce{Nb}}^{\mu}    &= 0.525\\
			x_{\ce{Cr}}^{\mu}    &= \frac{x_{\ce{Cr}}}{1 + x_{\ce{Nb}}^{\mu} - x_{\ce{Nb}}}
		\end{align*}
		\begin{align*}
			x_{\ce{Nb}}^{\ce{L}} &= 0.30\\
			x_{\ce{Cr}}^{\ce{L}} &= \frac{x_{\ce{Cr}}}{1 + x_{\ce{Nb}}^{\ce{L}} - x_{\ce{Nb}}}
		\end{align*}

	\begin{thebibliography}{1}
		\bibitem{Kim1999} Kim, S. G.; Kim, W. T. and Suzuki, T.
		                  ``Phase-field model for binary alloys.''
		                  \emph{Phys. Rev. E} \textbf{60} (1999) 7186--7197.
		                  DOI:~10.1103/PhysRevE.60.7186.

		\bibitem{Karunaratne2005} Karunaratne, M. S. A. and Reed, R. C.
		                          ``Interdiffusion of Niobium and Molybdenum in Nickel between 900 - \SI{1300}{\degreeCelsius}.''
		                          \emph{Defect and Diffusion Forum} \textbf{237-240} (2005) 420--425.
		                          DOI:~10.4028/www.scientific.net/DDF.237-240.420.

		\bibitem{Provatas2010} Provatas, N. and Elder, K.
		                       \emph{Phase-Field Methods in Materials Science and Engineering.}
		                       Wiley-VCH: Weinheim, 2010.
		                       ISBN:~978-3-527-40747-7.

		\bibitem{Zhou2014} Zhou, N.; Lv, D.; Zhang, H.; McAllister, D.; Zhang, F.; Mills, M. and Wang, Y.
		                   ``Computer simulation of phase transformation and plastic deformation in IN718 superalloy: Microstructural evolution during precipitation.''
		                   \emph{Acta Mater.} \textbf{65} (2014) 270--286.
		                   DOI:~10.1016/j.actamat.2013.10.069.
	\end{thebibliography}
\end{document}
